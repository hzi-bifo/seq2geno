Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	4	convert_to_sin
	1	create_and_make_expr_table
	1	create_coding_regions_aln
	4	create_consensus_sequence
	4	create_vcf
	1	find_best_tree
	4	gene_counts
	1	load_reference
	4	mapping
	1	postprocess_alignment
	4	process_vcf
	4	rna_mapping
	4	sort_bam
	1	write_dict_file
	39

rule load_reference:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa
    output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash
    jobid: 37

Finished job 37.
1 of 39 steps (3%) done

rule rna_mapping:
    input: data/strains/rna/F1659.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/F1659/sorted.rmdup.sam
    jobid: 30
    wildcards: sample=F1659

Finished job 30.
2 of 39 steps (5%) done

rule convert_to_sin:
    input: tmp/F1659/sorted.rmdup.sam
    output: tmp/F1659/sorted.rmdup.sin
    jobid: 22
    wildcards: TMP_D=tmp, sample=F1659

Removing temporary output file tmp/F1659/sorted.rmdup.sam.
Finished job 22.
3 of 39 steps (8%) done

rule gene_counts:
    input: tmp/F1659/sorted.rmdup.sin
    output: tmp/F1659/sorted.rmdup.rpg
    jobid: 13
    wildcards: TMP_D=tmp, sample=F1659

Removing temporary output file tmp/F1659/sorted.rmdup.sin.
Finished job 13.
4 of 39 steps (10%) done

rule rna_mapping:
    input: data/strains/rna/CH2522.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2522/sorted.rmdup.sam
    jobid: 28
    wildcards: sample=CH2522

Finished job 28.
5 of 39 steps (13%) done

rule convert_to_sin:
    input: tmp/CH2522/sorted.rmdup.sam
    output: tmp/CH2522/sorted.rmdup.sin
    jobid: 20
    wildcards: TMP_D=tmp, sample=CH2522

Removing temporary output file tmp/CH2522/sorted.rmdup.sam.
Finished job 20.
6 of 39 steps (15%) done

rule rna_mapping:
    input: data/strains/rna/CH2502.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2502/sorted.rmdup.sam
    jobid: 31
    wildcards: sample=CH2502

Finished job 31.
7 of 39 steps (18%) done

rule convert_to_sin:
    input: tmp/CH2502/sorted.rmdup.sam
    output: tmp/CH2502/sorted.rmdup.sin
    jobid: 23
    wildcards: TMP_D=tmp, sample=CH2502

Removing temporary output file tmp/CH2502/sorted.rmdup.sam.
Finished job 23.
8 of 39 steps (21%) done

rule rna_mapping:
    input: data/strains/rna/CH2500.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2500/sorted.rmdup.sam
    jobid: 29
    wildcards: sample=CH2500

Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash.
Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx.
Finished job 29.
9 of 39 steps (23%) done

rule convert_to_sin:
    input: tmp/CH2500/sorted.rmdup.sam
    output: tmp/CH2500/sorted.rmdup.sin
    jobid: 21
    wildcards: TMP_D=tmp, sample=CH2500

Removing temporary output file tmp/CH2500/sorted.rmdup.sam.
Finished job 21.
10 of 39 steps (26%) done

rule gene_counts:
    input: tmp/CH2522/sorted.rmdup.sin
    output: tmp/CH2522/sorted.rmdup.rpg
    jobid: 11
    wildcards: TMP_D=tmp, sample=CH2522

Removing temporary output file tmp/CH2522/sorted.rmdup.sin.
Finished job 11.
11 of 39 steps (28%) done

rule gene_counts:
    input: tmp/CH2502/sorted.rmdup.sin
    output: tmp/CH2502/sorted.rmdup.rpg
    jobid: 14
    wildcards: TMP_D=tmp, sample=CH2502

Removing temporary output file tmp/CH2502/sorted.rmdup.sin.
Finished job 14.
12 of 39 steps (31%) done

rule gene_counts:
    input: tmp/CH2500/sorted.rmdup.sin
    output: tmp/CH2500/sorted.rmdup.rpg
    jobid: 12
    wildcards: TMP_D=tmp, sample=CH2500

Removing temporary output file tmp/CH2500/sorted.rmdup.sin.
Finished job 12.
13 of 39 steps (33%) done

rule mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/F1659_1.fq.gz, data/strains/dna/F1659_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/F1659/bwa.raw.bam
    jobid: 48
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

Finished job 48.
14 of 39 steps (36%) done

rule sort_bam:
    input: tmp/F1659/bwa.raw.bam
    output: tmp/F1659/bwa.sorted.bam, tmp/F1659/bwa.sorted.bam.bai
    jobid: 44
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

Removing temporary output file tmp/F1659/bwa.raw.bam.
Finished job 44.
15 of 39 steps (38%) done

rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/F1659/bwa.sorted.bam, tmp/F1659/bwa.sorted.bam.bai
    output: tmp/F1659/bwa.vcf
    jobid: 40
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

Removing temporary output file tmp/F1659/bwa.sorted.bam.
Removing temporary output file tmp/F1659/bwa.sorted.bam.bai.
Finished job 40.
16 of 39 steps (41%) done

rule mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2500_1.fq.gz, data/strains/dna/CH2500_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2500/bwa.raw.bam
    jobid: 49
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

Finished job 49.
17 of 39 steps (44%) done

rule sort_bam:
    input: tmp/CH2500/bwa.raw.bam
    output: tmp/CH2500/bwa.sorted.bam, tmp/CH2500/bwa.sorted.bam.bai
    jobid: 45
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

Removing temporary output file tmp/CH2500/bwa.raw.bam.
Finished job 45.
18 of 39 steps (46%) done

rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2500/bwa.sorted.bam, tmp/CH2500/bwa.sorted.bam.bai
    output: tmp/CH2500/bwa.vcf
    jobid: 41
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

Removing temporary output file tmp/CH2500/bwa.sorted.bam.bai.
Removing temporary output file tmp/CH2500/bwa.sorted.bam.
Finished job 41.
19 of 39 steps (49%) done

rule mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2522_1.fq.gz, data/strains/dna/CH2522_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2522/bwa.raw.bam
    jobid: 46
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

Finished job 46.
20 of 39 steps (51%) done

rule sort_bam:
    input: tmp/CH2522/bwa.raw.bam
    output: tmp/CH2522/bwa.sorted.bam, tmp/CH2522/bwa.sorted.bam.bai
    jobid: 42
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

Removing temporary output file tmp/CH2522/bwa.raw.bam.
Finished job 42.
21 of 39 steps (54%) done

rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2522/bwa.sorted.bam, tmp/CH2522/bwa.sorted.bam.bai
    output: tmp/CH2522/bwa.vcf
    jobid: 38
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

Removing temporary output file tmp/CH2522/bwa.sorted.bam.
Removing temporary output file tmp/CH2522/bwa.sorted.bam.bai.
Finished job 38.
22 of 39 steps (56%) done

rule mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2502_1.fq.gz, data/strains/dna/CH2502_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2502/bwa.raw.bam
    jobid: 47
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt.
Finished job 47.
23 of 39 steps (59%) done

rule sort_bam:
    input: tmp/CH2502/bwa.raw.bam
    output: tmp/CH2502/bwa.sorted.bam, tmp/CH2502/bwa.sorted.bam.bai
    jobid: 43
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file tmp/CH2502/bwa.raw.bam.
Finished job 43.
24 of 39 steps (62%) done

rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2502/bwa.sorted.bam, tmp/CH2502/bwa.sorted.bam.bai
    output: tmp/CH2502/bwa.vcf
    jobid: 39
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file tmp/CH2502/bwa.sorted.bam.
Removing temporary output file tmp/CH2502/bwa.sorted.bam.bai.
Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai.
Finished job 39.
25 of 39 steps (64%) done

rule process_vcf:
    input: tmp/CH2522/bwa.vcf
    output: tmp/CH2522/bwa.vcf.gz
    jobid: 33
    wildcards: TMP_D=tmp, strains=CH2522, mapper=bwa

Finished job 33.
26 of 39 steps (67%) done

rule process_vcf:
    input: tmp/CH2502/bwa.vcf
    output: tmp/CH2502/bwa.vcf.gz
    jobid: 34
    wildcards: TMP_D=tmp, strains=CH2502, mapper=bwa

Finished job 34.
27 of 39 steps (69%) done

rule process_vcf:
    input: tmp/F1659/bwa.vcf
    output: tmp/F1659/bwa.vcf.gz
    jobid: 35
    wildcards: TMP_D=tmp, strains=F1659, mapper=bwa

Finished job 35.
28 of 39 steps (72%) done

rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2522/bwa.vcf.gz
    output: tmp/CH2522/bwa.cons.fa
    jobid: 24
    wildcards: TMP_D=tmp, strains=CH2522, mapper=bwa

Finished job 24.
29 of 39 steps (74%) done

rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2502/bwa.vcf.gz
    output: tmp/CH2502/bwa.cons.fa
    jobid: 25
    wildcards: TMP_D=tmp, strains=CH2502, mapper=bwa

Finished job 25.
30 of 39 steps (77%) done

rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/F1659/bwa.vcf.gz
    output: tmp/F1659/bwa.cons.fa
    jobid: 26
    wildcards: TMP_D=tmp, strains=F1659, mapper=bwa

Finished job 26.
31 of 39 steps (79%) done

rule process_vcf:
    input: tmp/CH2500/bwa.vcf
    output: tmp/CH2500/bwa.vcf.gz
    jobid: 36
    wildcards: TMP_D=tmp, strains=CH2500, mapper=bwa

Finished job 36.
32 of 39 steps (82%) done

rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2500/bwa.vcf.gz
    output: tmp/CH2500/bwa.cons.fa
    jobid: 27
    wildcards: TMP_D=tmp, strains=CH2500, mapper=bwa

Finished job 27.
33 of 39 steps (85%) done

rule create_coding_regions_aln:
    input: tmp/CH2500/bwa.cons.fa, tmp/CH2502/bwa.cons.fa, tmp/CH2522/bwa.cons.fa, tmp/F1659/bwa.cons.fa
    output: tmp/OneBig.aln
    jobid: 15
    wildcards: TMP_D=tmp

