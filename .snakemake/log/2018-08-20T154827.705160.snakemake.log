Building DAG of jobs...
Job counts:
	count	jobs
	1	all
	1	all_snps_table
	4	compute_flatcounts
	1	compute_gpa_table
	4	convert_to_sin
	4	count_cov
	1	covert_snps_table
	1	create_and_make_expr_table
	1	create_coding_regions_aln
	4	create_consensus_sequence
	1	create_indel_table
	4	create_vcf
	4	filter_vcf
	1	find_best_tree
	4	for_tab_create_vcf
	4	for_tab_index_vcf
	4	for_tab_sort_bam
	4	gene_counts
	4	index_vcf
	4	paired_mapping
	4	paired_read_bwa_mapping
	1	postprocess_alignment
	4	rna_mapping
	4	sort_bam
	4	stampy_remapping
	1	syn_snps_table
	1	write_dict_file
	75

[Mon Aug 20 15:48:29 2018]
rule rna_mapping:
    input: data/strains/rna/CH2500.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2500/rna_sorted.rmdup.sam, tmp/CH2500/rna_sorted.bam, tmp/CH2500/rna_sorted.rmdup.bam
    jobid: 71
    wildcards: sample=CH2500

source activate py27;/home/thkuo/bin/stampy-1.0.23/stampy.py --bwaoptions="-q10 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa" -t16 -g /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -h /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -M data/strains/rna/CH2500.fastq.gz | samtools view -bS -@ 16 |samtools sort > tmp/CH2500/rna_sorted.bam;samtools rmdup -s tmp/CH2500/rna_sorted.bam tmp/CH2500/rna_sorted.rmdup.bam;samtools view -h tmp/CH2500/rna_sorted.rmdup.bam > tmp/CH2500/rna_sorted.rmdup.sam ;source deactivate;

[Mon Aug 20 15:48:29 2018]
rule paired_read_bwa_mapping:
    input: data/strains/dna/CH2500_1.fq.gz, data/strains/dna/CH2500_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2500/bwa/dna1.bwa.sai, tmp/CH2500/bwa/dna2.bwa.sai, tmp/CH2500/bwa/dna.bwa.bam
    jobid: 90
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        bwa aln -q10 -t16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2500_1.fq.gz         > tmp/CH2500/bwa/dna1.bwa.sai

        bwa aln -q10 -t16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2500_2.fq.gz         > tmp/CH2500/bwa/dna2.bwa.sai 

        bwa sampe /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/CH2500/bwa/dna1.bwa.sai tmp/CH2500/bwa/dna2.bwa.sai         data/strains/dna/CH2500_1.fq.gz data/strains/dna/CH2500_2.fq.gz |         samtools view -bS -@ 16         > tmp/CH2500/bwa/dna.bwa.bam
        

[Mon Aug 20 15:48:29 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2500_1.fq.gz, data/strains/dna/CH2500_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2500/bwa/paired.bam
    jobid: 88
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2500_1.fq.gz data/strains/dna/CH2500_2.fq.gz|        samtools view -b -@ 16 > tmp/CH2500/bwa/paired.bam
        

[Mon Aug 20 15:48:29 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2522_1.fq.gz, data/strains/dna/CH2522_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2522/bwa/paired.bam
    jobid: 89
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2522_1.fq.gz data/strains/dna/CH2522_2.fq.gz|        samtools view -b -@ 16 > tmp/CH2522/bwa/paired.bam
        

[Mon Aug 20 15:48:29 2018]
rule compute_gpa_table:
    input: tmp/roary/gene_presence_absence.csv
    output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/results/gpa.tab
    jobid: 3

[Mon Aug 20 15:48:29 2018]
rule rna_mapping:
    input: data/strains/rna/F1659.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/F1659/rna_sorted.rmdup.sam, tmp/F1659/rna_sorted.bam, tmp/F1659/rna_sorted.rmdup.bam
    jobid: 69
    wildcards: sample=F1659

source activate py27;/home/thkuo/bin/stampy-1.0.23/stampy.py --bwaoptions="-q10 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa" -t16 -g /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -h /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -M data/strains/rna/F1659.fastq.gz | samtools view -bS -@ 16 |samtools sort > tmp/F1659/rna_sorted.bam;samtools rmdup -s tmp/F1659/rna_sorted.bam tmp/F1659/rna_sorted.rmdup.bam;samtools view -h tmp/F1659/rna_sorted.rmdup.bam > tmp/F1659/rna_sorted.rmdup.sam ;source deactivate;

[Mon Aug 20 15:48:29 2018]
rule rna_mapping:
    input: data/strains/rna/CH2502.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2502/rna_sorted.rmdup.sam, tmp/CH2502/rna_sorted.bam, tmp/CH2502/rna_sorted.rmdup.bam
    jobid: 68
    wildcards: sample=CH2502

source activate py27;/home/thkuo/bin/stampy-1.0.23/stampy.py --bwaoptions="-q10 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa" -t16 -g /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -h /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -M data/strains/rna/CH2502.fastq.gz | samtools view -bS -@ 16 |samtools sort > tmp/CH2502/rna_sorted.bam;samtools rmdup -s tmp/CH2502/rna_sorted.bam tmp/CH2502/rna_sorted.rmdup.bam;samtools view -h tmp/CH2502/rna_sorted.rmdup.bam > tmp/CH2502/rna_sorted.rmdup.sam ;source deactivate;

[Mon Aug 20 15:48:29 2018]
rule paired_read_bwa_mapping:
    input: data/strains/dna/CH2522_1.fq.gz, data/strains/dna/CH2522_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2522/bwa/dna1.bwa.sai, tmp/CH2522/bwa/dna2.bwa.sai, tmp/CH2522/bwa/dna.bwa.bam
    jobid: 91
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        bwa aln -q10 -t16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2522_1.fq.gz         > tmp/CH2522/bwa/dna1.bwa.sai

        bwa aln -q10 -t16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2522_2.fq.gz         > tmp/CH2522/bwa/dna2.bwa.sai 

        bwa sampe /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/CH2522/bwa/dna1.bwa.sai tmp/CH2522/bwa/dna2.bwa.sai         data/strains/dna/CH2522_1.fq.gz data/strains/dna/CH2522_2.fq.gz |         samtools view -bS -@ 16         > tmp/CH2522/bwa/dna.bwa.bam
        

[Mon Aug 20 15:48:29 2018]
rule paired_read_bwa_mapping:
    input: data/strains/dna/F1659_1.fq.gz, data/strains/dna/F1659_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/F1659/bwa/dna1.bwa.sai, tmp/F1659/bwa/dna2.bwa.sai, tmp/F1659/bwa/dna.bwa.bam
    jobid: 92
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        bwa aln -q10 -t16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/F1659_1.fq.gz         > tmp/F1659/bwa/dna1.bwa.sai

        bwa aln -q10 -t16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/F1659_2.fq.gz         > tmp/F1659/bwa/dna2.bwa.sai 

        bwa sampe /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/F1659/bwa/dna1.bwa.sai tmp/F1659/bwa/dna2.bwa.sai         data/strains/dna/F1659_1.fq.gz data/strains/dna/F1659_2.fq.gz |         samtools view -bS -@ 16         > tmp/F1659/bwa/dna.bwa.bam
        

[Mon Aug 20 15:48:29 2018]
rule paired_read_bwa_mapping:
    input: data/strains/dna/CH2502_1.fq.gz, data/strains/dna/CH2502_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2502/bwa/dna1.bwa.sai, tmp/CH2502/bwa/dna2.bwa.sai, tmp/CH2502/bwa/dna.bwa.bam
    jobid: 93
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        bwa aln -q10 -t16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2502_1.fq.gz         > tmp/CH2502/bwa/dna1.bwa.sai

        bwa aln -q10 -t16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2502_2.fq.gz         > tmp/CH2502/bwa/dna2.bwa.sai 

        bwa sampe /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/CH2502/bwa/dna1.bwa.sai tmp/CH2502/bwa/dna2.bwa.sai         data/strains/dna/CH2502_1.fq.gz data/strains/dna/CH2502_2.fq.gz |         samtools view -bS -@ 16         > tmp/CH2502/bwa/dna.bwa.bam
        

[Mon Aug 20 15:48:29 2018]
rule rna_mapping:
    input: data/strains/rna/CH2522.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2522/rna_sorted.rmdup.sam, tmp/CH2522/rna_sorted.bam, tmp/CH2522/rna_sorted.rmdup.bam
    jobid: 70
    wildcards: sample=CH2522

source activate py27;/home/thkuo/bin/stampy-1.0.23/stampy.py --bwaoptions="-q10 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa" -t16 -g /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -h /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -M data/strains/rna/CH2522.fastq.gz | samtools view -bS -@ 16 |samtools sort > tmp/CH2522/rna_sorted.bam;samtools rmdup -s tmp/CH2522/rna_sorted.bam tmp/CH2522/rna_sorted.rmdup.bam;samtools view -h tmp/CH2522/rna_sorted.rmdup.bam > tmp/CH2522/rna_sorted.rmdup.sam ;source deactivate;

[Mon Aug 20 15:48:29 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/F1659_1.fq.gz, data/strains/dna/F1659_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/F1659/bwa/paired.bam
    jobid: 87
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/F1659_1.fq.gz data/strains/dna/F1659_2.fq.gz|        samtools view -b -@ 16 > tmp/F1659/bwa/paired.bam
        

[Mon Aug 20 15:48:29 2018]
rule create_indel_table:
    input: tmp/indel.list
    output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/results/annot.tab, indels_stats.txt
    jobid: 5

[Mon Aug 20 15:48:29 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2502_1.fq.gz, data/strains/dna/CH2502_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2502/bwa/paired.bam
    jobid: 86
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2502_1.fq.gz data/strains/dna/CH2502_2.fq.gz|        samtools view -b -@ 16 > tmp/CH2502/bwa/paired.bam
        

[Mon Aug 20 15:48:29 2018]
rule convert_to_sin:
    input: tmp/CH2500/rna_sorted.rmdup.sam
    output: tmp/CH2500/rna_sorted.rmdup.sin
    jobid: 41
    wildcards: TMP_D=tmp, sample=CH2500

/net/metagenomics/data/from_moni/old.tzuhao/Paeru/bin/from_SusanneLab/RNA-seq/sam2art.pl -s 2 -l tmp/CH2500/rna_sorted.rmdup.sam > tmp/CH2500/rna_sorted.rmdup.sin 

[Mon Aug 20 15:48:29 2018]
rule sort_bam:
    input: tmp/CH2500/bwa/paired.bam
    output: tmp/CH2500/bwa/sorted.bam, tmp/CH2500/bwa/sorted.bam.bai
    jobid: 80
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        bamtools sort -in tmp/CH2500/bwa/paired.bam -out tmp/CH2500/bwa/sorted.bam
        samtools index tmp/CH2500/bwa/sorted.bam
        

[Mon Aug 20 15:48:29 2018]
rule sort_bam:
    input: tmp/CH2522/bwa/paired.bam
    output: tmp/CH2522/bwa/sorted.bam, tmp/CH2522/bwa/sorted.bam.bai
    jobid: 81
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        bamtools sort -in tmp/CH2522/bwa/paired.bam -out tmp/CH2522/bwa/sorted.bam
        samtools index tmp/CH2522/bwa/sorted.bam
        

[Mon Aug 20 15:48:29 2018]
rule stampy_remapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash, tmp/F1659/bwa/dna.bwa.bam
    output: tmp/F1659/bwa/st_paired.bam
    jobid: 84
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

RuleException in line 42 of /net/sgi/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v5/DETECT_SNPS_FOR_TABLE.smk:
'InputFiles' object has no attribute 'BWA_BAM'
