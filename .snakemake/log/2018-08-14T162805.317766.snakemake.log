Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	1	create_coding_regions_aln
	4	create_consensus_sequence
	4	create_vcf
	1	find_best_tree
	1	load_reference
	4	paired_mapping
	1	postprocess_alignment
	4	sort_bam
	21

[Tue Aug 14 16:28:09 2018]
rule load_reference:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa
    output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash
    jobid: 33

Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx.
Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash.
[Tue Aug 14 16:28:17 2018]
Finished job 33.
1 of 21 steps (5%) done

[Tue Aug 14 16:28:17 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/F1659_1.fq.gz, data/strains/dna/F1659_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/F1659/bwa/paired.bam
    jobid: 39
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

[Tue Aug 14 16:28:40 2018]
Finished job 39.
2 of 21 steps (10%) done

[Tue Aug 14 16:28:40 2018]
rule sort_bam:
    input: tmp/F1659/bwa/paired.bam
    output: tmp/F1659/bwa/sorted.bam, tmp/F1659/bwa/sorted.bam.bai
    jobid: 35
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

Removing temporary output file tmp/F1659/bwa/paired.bam.
[Tue Aug 14 16:31:18 2018]
Finished job 35.
3 of 21 steps (14%) done

[Tue Aug 14 16:31:18 2018]
rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/F1659/bwa/sorted.bam, tmp/F1659/bwa/sorted.bam.bai
    output: tmp/F1659/bwa/vcf.gz, tmp/F1659/bwa/vcf.gz.tbi
    jobid: 25
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

Removing temporary output file tmp/F1659/bwa/sorted.bam.bai.
Removing temporary output file tmp/F1659/bwa/sorted.bam.
[Tue Aug 14 16:31:58 2018]
Finished job 25.
4 of 21 steps (19%) done

[Tue Aug 14 16:31:58 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2500_1.fq.gz, data/strains/dna/CH2500_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2500/bwa/paired.bam
    jobid: 37
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

[Tue Aug 14 16:32:11 2018]
Finished job 37.
5 of 21 steps (24%) done

[Tue Aug 14 16:32:11 2018]
rule sort_bam:
    input: tmp/CH2500/bwa/paired.bam
    output: tmp/CH2500/bwa/sorted.bam, tmp/CH2500/bwa/sorted.bam.bai
    jobid: 32
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

Removing temporary output file tmp/CH2500/bwa/paired.bam.
[Tue Aug 14 16:33:19 2018]
Finished job 32.
6 of 21 steps (29%) done

[Tue Aug 14 16:33:19 2018]
rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2500/bwa/sorted.bam, tmp/CH2500/bwa/sorted.bam.bai
    output: tmp/CH2500/bwa/vcf.gz, tmp/CH2500/bwa/vcf.gz.tbi
    jobid: 23
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

Removing temporary output file tmp/CH2500/bwa/sorted.bam.bai.
Removing temporary output file tmp/CH2500/bwa/sorted.bam.
[Tue Aug 14 16:33:41 2018]
Finished job 23.
7 of 21 steps (33%) done

[Tue Aug 14 16:33:41 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2522_1.fq.gz, data/strains/dna/CH2522_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2522/bwa/paired.bam
    jobid: 38
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

[Tue Aug 14 16:33:56 2018]
Finished job 38.
8 of 21 steps (38%) done

[Tue Aug 14 16:33:56 2018]
rule sort_bam:
    input: tmp/CH2522/bwa/paired.bam
    output: tmp/CH2522/bwa/sorted.bam, tmp/CH2522/bwa/sorted.bam.bai
    jobid: 34
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

Removing temporary output file tmp/CH2522/bwa/paired.bam.
[Tue Aug 14 16:35:03 2018]
Finished job 34.
9 of 21 steps (43%) done

[Tue Aug 14 16:35:03 2018]
rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2522/bwa/sorted.bam, tmp/CH2522/bwa/sorted.bam.bai
    output: tmp/CH2522/bwa/vcf.gz, tmp/CH2522/bwa/vcf.gz.tbi
    jobid: 24
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

Removing temporary output file tmp/CH2522/bwa/sorted.bam.bai.
Removing temporary output file tmp/CH2522/bwa/sorted.bam.
[Tue Aug 14 16:35:43 2018]
Finished job 24.
10 of 21 steps (48%) done

[Tue Aug 14 16:35:43 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2502_1.fq.gz, data/strains/dna/CH2502_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2502/bwa/paired.bam
    jobid: 40
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt.
[Tue Aug 14 16:35:58 2018]
Finished job 40.
11 of 21 steps (52%) done

[Tue Aug 14 16:35:58 2018]
rule sort_bam:
    input: tmp/CH2502/bwa/paired.bam
    output: tmp/CH2502/bwa/sorted.bam, tmp/CH2502/bwa/sorted.bam.bai
    jobid: 36
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file tmp/CH2502/bwa/paired.bam.
[Tue Aug 14 16:37:01 2018]
Finished job 36.
12 of 21 steps (57%) done

[Tue Aug 14 16:37:01 2018]
rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2502/bwa/sorted.bam, tmp/CH2502/bwa/sorted.bam.bai
    output: tmp/CH2502/bwa/vcf.gz, tmp/CH2502/bwa/vcf.gz.tbi
    jobid: 26
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file tmp/CH2502/bwa/sorted.bam.bai.
Removing temporary output file tmp/CH2502/bwa/sorted.bam.
Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai.
[Tue Aug 14 16:37:32 2018]
Finished job 26.
13 of 21 steps (62%) done

[Tue Aug 14 16:37:32 2018]
rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2522/bwa/vcf.gz, tmp/CH2522/bwa/vcf.gz.tbi
    output: tmp/CH2522/bwa/cons.fa
    jobid: 14
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

Removing temporary output file tmp/CH2522/bwa/vcf.gz.tbi.
[Tue Aug 14 16:37:47 2018]
Finished job 14.
14 of 21 steps (67%) done

[Tue Aug 14 16:37:47 2018]
rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2502/bwa/vcf.gz, tmp/CH2502/bwa/vcf.gz.tbi
    output: tmp/CH2502/bwa/cons.fa
    jobid: 16
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file tmp/CH2502/bwa/vcf.gz.tbi.
[Tue Aug 14 16:38:08 2018]
Finished job 16.
15 of 21 steps (71%) done

[Tue Aug 14 16:38:08 2018]
rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/F1659/bwa/vcf.gz, tmp/F1659/bwa/vcf.gz.tbi
    output: tmp/F1659/bwa/cons.fa
    jobid: 15
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

Removing temporary output file tmp/F1659/bwa/vcf.gz.tbi.
[Tue Aug 14 16:38:28 2018]
Finished job 15.
16 of 21 steps (76%) done

[Tue Aug 14 16:38:28 2018]
rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2500/bwa/vcf.gz, tmp/CH2500/bwa/vcf.gz.tbi
    output: tmp/CH2500/bwa/cons.fa
    jobid: 13
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

Removing temporary output file tmp/CH2500/bwa/vcf.gz.tbi.
[Tue Aug 14 16:38:44 2018]
Finished job 13.
17 of 21 steps (81%) done

[Tue Aug 14 16:38:44 2018]
rule create_coding_regions_aln:
    input: tmp/CH2500/bwa/cons.fa, tmp/CH2502/bwa/cons.fa, tmp/CH2522/bwa/cons.fa, tmp/F1659/bwa/cons.fa
    output: tmp/OneBig.aln
    jobid: 7
    wildcards: TMP_D=tmp

[Tue Aug 14 17:25:06 2018]
Finished job 7.
18 of 21 steps (86%) done

[Tue Aug 14 17:25:06 2018]
rule postprocess_alignment:
    input: tmp/OneBig.aln
    output: tmp/OneBig.var.aln
    jobid: 4
    wildcards: TMP_D=tmp

[Tue Aug 14 17:25:11 2018]
Finished job 4.
19 of 21 steps (90%) done

[Tue Aug 14 17:25:11 2018]
rule find_best_tree:
    input: tmp/OneBig.var.aln
    output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/results/Paeru.nwk
    jobid: 1

[Tue Aug 14 17:25:12 2018]
Finished job 1.
20 of 21 steps (95%) done

[Tue Aug 14 17:25:12 2018]
localrule all:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/results/Paeru.nwk, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/results/annot.tab, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/results/gpa.tab
    jobid: 0

[Tue Aug 14 17:25:12 2018]
Finished job 0.
21 of 21 steps (100%) done
Complete log: /net/sgi/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/.snakemake/log/2018-08-14T162805.317766.snakemake.log
