Building DAG of jobs...
Job counts:
	count	jobs
	1	all
	1	all_snps_table
	4	compute_flatcounts
	1	compute_gpa_table
	4	convert_to_sin
	4	count_cov
	1	covert_snps_table
	1	create_and_make_expr_table
	1	create_coding_regions_aln
	4	create_consensus_sequence
	1	create_indel_table
	4	create_vcf
	4	filter_vcf
	1	find_best_tree
	4	for_tab_create_vcf
	4	for_tab_index_vcf
	4	for_tab_paired_mapping
	4	for_tab_sort_bam
	4	gene_counts
	4	index_vcf
	4	paired_mapping
	1	postprocess_alignment
	4	rna_mapping
	4	sort_bam
	1	syn_snps_table
	1	write_dict_file
	71

[Mon Aug 20 14:49:42 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2502_1.fq.gz, data/strains/dna/CH2502_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2502/bwa/paired.bam
    jobid: 86
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2502_1.fq.gz data/strains/dna/CH2502_2.fq.gz|        samtools view -b -@ 16 > tmp/CH2502/bwa/paired.bam
        

[Mon Aug 20 14:49:42 2018]
rule rna_mapping:
    input: data/strains/rna/CH2500.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2500/rna_sorted.rmdup.sam, tmp/CH2500/rna_sorted.bam, tmp/CH2500/rna_sorted.rmdup.bam
    jobid: 70
    wildcards: sample=CH2500

source activate py27;/home/thkuo/bin/stampy-1.0.23/stampy.py --bwaoptions="-q10 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa" -t16 -g /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -h /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -M data/strains/rna/CH2500.fastq.gz | samtools view -bS -@ 16 |samtools sort > tmp/CH2500/rna_sorted.bam;samtools rmdup -s tmp/CH2500/rna_sorted.bam tmp/CH2500/rna_sorted.rmdup.bam;samtools view -h tmp/CH2500/rna_sorted.rmdup.bam > tmp/CH2500/rna_sorted.rmdup.sam ;source deactivate;

[Mon Aug 20 14:49:42 2018]
rule for_tab_paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2500_1.fq.gz, data/strains/dna/CH2500_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2500/bwa/st_paired.bam
    jobid: 84
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2500_1.fq.gz data/strains/dna/CH2500_2.fq.gz|        samtools view -b -@ 16 > tmp/CH2500/bwa/st_paired.bam
        

[Mon Aug 20 14:49:42 2018]
rule rna_mapping:
    input: data/strains/rna/CH2522.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2522/rna_sorted.rmdup.sam, tmp/CH2522/rna_sorted.bam, tmp/CH2522/rna_sorted.rmdup.bam
    jobid: 71
    wildcards: sample=CH2522

source activate py27;/home/thkuo/bin/stampy-1.0.23/stampy.py --bwaoptions="-q10 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa" -t16 -g /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -h /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -M data/strains/rna/CH2522.fastq.gz | samtools view -bS -@ 16 |samtools sort > tmp/CH2522/rna_sorted.bam;samtools rmdup -s tmp/CH2522/rna_sorted.bam tmp/CH2522/rna_sorted.rmdup.bam;samtools view -h tmp/CH2522/rna_sorted.rmdup.bam > tmp/CH2522/rna_sorted.rmdup.sam ;source deactivate;

[Mon Aug 20 14:49:42 2018]
rule for_tab_paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2522_1.fq.gz, data/strains/dna/CH2522_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2522/bwa/st_paired.bam
    jobid: 83
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2522_1.fq.gz data/strains/dna/CH2522_2.fq.gz|        samtools view -b -@ 16 > tmp/CH2522/bwa/st_paired.bam
        

[Mon Aug 20 14:49:42 2018]
rule rna_mapping:
    input: data/strains/rna/F1659.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/F1659/rna_sorted.rmdup.sam, tmp/F1659/rna_sorted.bam, tmp/F1659/rna_sorted.rmdup.bam
    jobid: 72
    wildcards: sample=F1659

source activate py27;/home/thkuo/bin/stampy-1.0.23/stampy.py --bwaoptions="-q10 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa" -t16 -g /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -h /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -M data/strains/rna/F1659.fastq.gz | samtools view -bS -@ 16 |samtools sort > tmp/F1659/rna_sorted.bam;samtools rmdup -s tmp/F1659/rna_sorted.bam tmp/F1659/rna_sorted.rmdup.bam;samtools view -h tmp/F1659/rna_sorted.rmdup.bam > tmp/F1659/rna_sorted.rmdup.sam ;source deactivate;

[Mon Aug 20 14:49:42 2018]
rule create_indel_table:
    input: tmp/indel.list
    output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/results/annot.tab, indels_stats.txt
    jobid: 3

[Mon Aug 20 14:49:42 2018]
rule for_tab_paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/F1659_1.fq.gz, data/strains/dna/F1659_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/F1659/bwa/st_paired.bam
    jobid: 82
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/F1659_1.fq.gz data/strains/dna/F1659_2.fq.gz|        samtools view -b -@ 16 > tmp/F1659/bwa/st_paired.bam
        

[Mon Aug 20 14:49:42 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/F1659_1.fq.gz, data/strains/dna/F1659_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/F1659/bwa/paired.bam
    jobid: 87
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/F1659_1.fq.gz data/strains/dna/F1659_2.fq.gz|        samtools view -b -@ 16 > tmp/F1659/bwa/paired.bam
        

[Mon Aug 20 14:49:42 2018]
rule compute_gpa_table:
    input: tmp/roary/gene_presence_absence.csv
    output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/results/gpa.tab
    jobid: 2

[Mon Aug 20 14:49:42 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2522_1.fq.gz, data/strains/dna/CH2522_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2522/bwa/paired.bam
    jobid: 88
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2522_1.fq.gz data/strains/dna/CH2522_2.fq.gz|        samtools view -b -@ 16 > tmp/CH2522/bwa/paired.bam
        

[Mon Aug 20 14:49:42 2018]
rule for_tab_paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2502_1.fq.gz, data/strains/dna/CH2502_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2502/bwa/st_paired.bam
    jobid: 85
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2502_1.fq.gz data/strains/dna/CH2502_2.fq.gz|        samtools view -b -@ 16 > tmp/CH2502/bwa/st_paired.bam
        

[Mon Aug 20 14:49:42 2018]
rule rna_mapping:
    input: data/strains/rna/CH2502.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2502/rna_sorted.rmdup.sam, tmp/CH2502/rna_sorted.bam, tmp/CH2502/rna_sorted.rmdup.bam
    jobid: 69
    wildcards: sample=CH2502

source activate py27;/home/thkuo/bin/stampy-1.0.23/stampy.py --bwaoptions="-q10 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa" -t16 -g /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -h /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa -M data/strains/rna/CH2502.fastq.gz | samtools view -bS -@ 16 |samtools sort > tmp/CH2502/rna_sorted.bam;samtools rmdup -s tmp/CH2502/rna_sorted.bam tmp/CH2502/rna_sorted.rmdup.bam;samtools view -h tmp/CH2502/rna_sorted.rmdup.bam > tmp/CH2502/rna_sorted.rmdup.sam ;source deactivate;

[Mon Aug 20 14:49:42 2018]
rule paired_mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2500_1.fq.gz, data/strains/dna/CH2500_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2500/bwa/paired.bam
    jobid: 89
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        bwa mem -v 2 -M -t 16 /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa data/strains/dna/CH2500_1.fq.gz data/strains/dna/CH2500_2.fq.gz|        samtools view -b -@ 16 > tmp/CH2500/bwa/paired.bam
        

[Mon Aug 20 14:49:42 2018]
rule for_tab_sort_bam:
    input: tmp/CH2502/bwa/st_paired.bam
    output: tmp/CH2502/bwa/st_sorted.bam, tmp/CH2502/bwa/st_sorted.bam.bai
    jobid: 77
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        bamtools sort -in tmp/CH2502/bwa/st_paired.bam -out tmp/CH2502/bwa/st_sorted.bam
        samtools index tmp/CH2502/bwa/st_sorted.bam
        

[Mon Aug 20 14:49:42 2018]
rule convert_to_sin:
    input: tmp/CH2502/rna_sorted.rmdup.sam
    output: tmp/CH2502/rna_sorted.rmdup.sin
    jobid: 39
    wildcards: TMP_D=tmp, sample=CH2502

/net/metagenomics/data/from_moni/old.tzuhao/Paeru/bin/from_SusanneLab/RNA-seq/sam2art.pl -s 2 -l tmp/CH2502/rna_sorted.rmdup.sam > tmp/CH2502/rna_sorted.rmdup.sin 

[Mon Aug 20 14:49:42 2018]
rule convert_to_sin:
    input: tmp/CH2522/rna_sorted.rmdup.sam
    output: tmp/CH2522/rna_sorted.rmdup.sin
    jobid: 41
    wildcards: TMP_D=tmp, sample=CH2522

/net/metagenomics/data/from_moni/old.tzuhao/Paeru/bin/from_SusanneLab/RNA-seq/sam2art.pl -s 2 -l tmp/CH2522/rna_sorted.rmdup.sam > tmp/CH2522/rna_sorted.rmdup.sin 

[Mon Aug 20 14:49:42 2018]
rule convert_to_sin:
    input: tmp/F1659/rna_sorted.rmdup.sam
    output: tmp/F1659/rna_sorted.rmdup.sin
    jobid: 42
    wildcards: TMP_D=tmp, sample=F1659

/net/metagenomics/data/from_moni/old.tzuhao/Paeru/bin/from_SusanneLab/RNA-seq/sam2art.pl -s 2 -l tmp/F1659/rna_sorted.rmdup.sam > tmp/F1659/rna_sorted.rmdup.sin 

[Mon Aug 20 14:49:42 2018]
rule for_tab_sort_bam:
    input: tmp/F1659/bwa/st_paired.bam
    output: tmp/F1659/bwa/st_sorted.bam, tmp/F1659/bwa/st_sorted.bam.bai
    jobid: 73
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        bamtools sort -in tmp/F1659/bwa/st_paired.bam -out tmp/F1659/bwa/st_sorted.bam
        samtools index tmp/F1659/bwa/st_sorted.bam
        

[Mon Aug 20 14:49:42 2018]
rule for_tab_sort_bam:
    input: tmp/CH2522/bwa/st_paired.bam
    output: tmp/CH2522/bwa/st_sorted.bam, tmp/CH2522/bwa/st_sorted.bam.bai
    jobid: 74
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        bamtools sort -in tmp/CH2522/bwa/st_paired.bam -out tmp/CH2522/bwa/st_sorted.bam
        samtools index tmp/CH2522/bwa/st_sorted.bam
        

[Mon Aug 20 14:49:42 2018]
rule convert_to_sin:
    input: tmp/CH2500/rna_sorted.rmdup.sam
    output: tmp/CH2500/rna_sorted.rmdup.sin
    jobid: 40
    wildcards: TMP_D=tmp, sample=CH2500

/net/metagenomics/data/from_moni/old.tzuhao/Paeru/bin/from_SusanneLab/RNA-seq/sam2art.pl -s 2 -l tmp/CH2500/rna_sorted.rmdup.sam > tmp/CH2500/rna_sorted.rmdup.sin 

[Mon Aug 20 14:49:42 2018]
rule for_tab_sort_bam:
    input: tmp/CH2500/bwa/st_paired.bam
    output: tmp/CH2500/bwa/st_sorted.bam, tmp/CH2500/bwa/st_sorted.bam.bai
    jobid: 76
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        bamtools sort -in tmp/CH2500/bwa/st_paired.bam -out tmp/CH2500/bwa/st_sorted.bam
        samtools index tmp/CH2500/bwa/st_sorted.bam
        

[Mon Aug 20 14:49:42 2018]
rule sort_bam:
    input: tmp/F1659/bwa/paired.bam
    output: tmp/F1659/bwa/sorted.bam, tmp/F1659/bwa/sorted.bam.bai
    jobid: 79
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        bamtools sort -in tmp/F1659/bwa/paired.bam -out tmp/F1659/bwa/sorted.bam
        samtools index tmp/F1659/bwa/sorted.bam
        

[Mon Aug 20 14:49:42 2018]
rule sort_bam:
    input: tmp/CH2522/bwa/paired.bam
    output: tmp/CH2522/bwa/sorted.bam, tmp/CH2522/bwa/sorted.bam.bai
    jobid: 80
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        bamtools sort -in tmp/CH2522/bwa/paired.bam -out tmp/CH2522/bwa/sorted.bam
        samtools index tmp/CH2522/bwa/sorted.bam
        

[Mon Aug 20 14:49:42 2018]
rule sort_bam:
    input: tmp/CH2500/bwa/paired.bam
    output: tmp/CH2500/bwa/sorted.bam, tmp/CH2500/bwa/sorted.bam.bai
    jobid: 81
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        bamtools sort -in tmp/CH2500/bwa/paired.bam -out tmp/CH2500/bwa/sorted.bam
        samtools index tmp/CH2500/bwa/sorted.bam
        

[Mon Aug 20 14:49:42 2018]
rule sort_bam:
    input: tmp/CH2502/bwa/paired.bam
    output: tmp/CH2502/bwa/sorted.bam, tmp/CH2502/bwa/sorted.bam.bai
    jobid: 78
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        bamtools sort -in tmp/CH2502/bwa/paired.bam -out tmp/CH2502/bwa/sorted.bam
        samtools index tmp/CH2502/bwa/sorted.bam
        

[Mon Aug 20 14:49:42 2018]
rule gene_counts:
    input: tmp/CH2522/rna_sorted.rmdup.sin
    output: tmp/CH2522/rna_sorted.rmdup.rpg
    jobid: 20
    wildcards: TMP_D=tmp, sample=CH2522

/net/metagenomics/data/from_moni/old.tzuhao/Paeru/bin/from_SusanneLab/RNA-seq/art2genecount.pl -b -a tmp/CH2522/rna_sorted.rmdup.sin -t tab -r Pseudomonas_aeruginosa_PA14_annotation_with_ncRNAs_07_2011_12genes.tab > tmp/CH2522/rna_sorted.rmdup.rpg

[Mon Aug 20 14:49:42 2018]
rule count_cov:
    input: tmp/CH2502/bwa/st_sorted.bam
    output: tmp/CH2502/bwa/st_mapping.coverage
    jobid: 50
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

samtools depth -a tmp/CH2502/bwa/st_sorted.bam > tmp/CH2502/bwa/st_mapping.coverage;

[Mon Aug 20 14:49:42 2018]
rule gene_counts:
    input: tmp/F1659/rna_sorted.rmdup.sin
    output: tmp/F1659/rna_sorted.rmdup.rpg
    jobid: 21
    wildcards: TMP_D=tmp, sample=F1659

/net/metagenomics/data/from_moni/old.tzuhao/Paeru/bin/from_SusanneLab/RNA-seq/art2genecount.pl -b -a tmp/F1659/rna_sorted.rmdup.sin -t tab -r Pseudomonas_aeruginosa_PA14_annotation_with_ncRNAs_07_2011_12genes.tab > tmp/F1659/rna_sorted.rmdup.rpg

[Mon Aug 20 14:49:42 2018]
rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/F1659/bwa/sorted.bam, tmp/F1659/bwa/sorted.bam.bai
    output: tmp/F1659/bwa/vcf.gz
    jobid: 63
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        freebayes-parallel <(fasta_generate_regions.py /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai 100000) 16 -f /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/F1659/bwa/sorted.bam |         bgzip -c > tmp/F1659/bwa/vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2522/bwa/sorted.bam, tmp/CH2522/bwa/sorted.bam.bai
    output: tmp/CH2522/bwa/vcf.gz
    jobid: 66
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        freebayes-parallel <(fasta_generate_regions.py /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai 100000) 16 -f /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/CH2522/bwa/sorted.bam |         bgzip -c > tmp/CH2522/bwa/vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule gene_counts:
    input: tmp/CH2500/rna_sorted.rmdup.sin
    output: tmp/CH2500/rna_sorted.rmdup.rpg
    jobid: 19
    wildcards: TMP_D=tmp, sample=CH2500

/net/metagenomics/data/from_moni/old.tzuhao/Paeru/bin/from_SusanneLab/RNA-seq/art2genecount.pl -b -a tmp/CH2500/rna_sorted.rmdup.sin -t tab -r Pseudomonas_aeruginosa_PA14_annotation_with_ncRNAs_07_2011_12genes.tab > tmp/CH2500/rna_sorted.rmdup.rpg

[Mon Aug 20 14:49:42 2018]
rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2500/bwa/sorted.bam, tmp/CH2500/bwa/sorted.bam.bai
    output: tmp/CH2500/bwa/vcf.gz
    jobid: 68
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        freebayes-parallel <(fasta_generate_regions.py /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai 100000) 16 -f /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/CH2500/bwa/sorted.bam |         bgzip -c > tmp/CH2500/bwa/vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule count_cov:
    input: tmp/CH2522/bwa/st_sorted.bam
    output: tmp/CH2522/bwa/st_mapping.coverage
    jobid: 44
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

samtools depth -a tmp/CH2522/bwa/st_sorted.bam > tmp/CH2522/bwa/st_mapping.coverage;

[Mon Aug 20 14:49:42 2018]
rule gene_counts:
    input: tmp/CH2502/rna_sorted.rmdup.sin
    output: tmp/CH2502/rna_sorted.rmdup.rpg
    jobid: 18
    wildcards: TMP_D=tmp, sample=CH2502

/net/metagenomics/data/from_moni/old.tzuhao/Paeru/bin/from_SusanneLab/RNA-seq/art2genecount.pl -b -a tmp/CH2502/rna_sorted.rmdup.sin -t tab -r Pseudomonas_aeruginosa_PA14_annotation_with_ncRNAs_07_2011_12genes.tab > tmp/CH2502/rna_sorted.rmdup.rpg

[Mon Aug 20 14:49:42 2018]
rule count_cov:
    input: tmp/F1659/bwa/st_sorted.bam
    output: tmp/F1659/bwa/st_mapping.coverage
    jobid: 43
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

samtools depth -a tmp/F1659/bwa/st_sorted.bam > tmp/F1659/bwa/st_mapping.coverage;

[Mon Aug 20 14:49:42 2018]
rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2502/bwa/sorted.bam, tmp/CH2502/bwa/sorted.bam.bai
    output: tmp/CH2502/bwa/vcf.gz
    jobid: 60
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        freebayes-parallel <(fasta_generate_regions.py /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai 100000) 16 -f /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/CH2502/bwa/sorted.bam |         bgzip -c > tmp/CH2502/bwa/vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule count_cov:
    input: tmp/CH2500/bwa/st_sorted.bam
    output: tmp/CH2500/bwa/st_mapping.coverage
    jobid: 49
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

samtools depth -a tmp/CH2500/bwa/st_sorted.bam > tmp/CH2500/bwa/st_mapping.coverage;

[Mon Aug 20 14:49:42 2018]
rule for_tab_create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2500/bwa/st_sorted.bam, tmp/CH2500/bwa/st_sorted.bam.bai
    output: tmp/CH2500/bwa/st_vcf.gz
    jobid: 48
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        freebayes-parallel <(fasta_generate_regions.py /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai 100000) 16 -f /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/CH2500/bwa/st_sorted.bam |         bgzip -c > tmp/CH2500/bwa/st_vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule for_tab_create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2522/bwa/st_sorted.bam, tmp/CH2522/bwa/st_sorted.bam.bai
    output: tmp/CH2522/bwa/st_vcf.gz
    jobid: 46
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        freebayes-parallel <(fasta_generate_regions.py /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai 100000) 16 -f /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/CH2522/bwa/st_sorted.bam |         bgzip -c > tmp/CH2522/bwa/st_vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule for_tab_create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/F1659/bwa/st_sorted.bam, tmp/F1659/bwa/st_sorted.bam.bai
    output: tmp/F1659/bwa/st_vcf.gz
    jobid: 52
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        freebayes-parallel <(fasta_generate_regions.py /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai 100000) 16 -f /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/F1659/bwa/st_sorted.bam |         bgzip -c > tmp/F1659/bwa/st_vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule for_tab_create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2502/bwa/st_sorted.bam, tmp/CH2502/bwa/st_sorted.bam.bai
    output: tmp/CH2502/bwa/st_vcf.gz
    jobid: 54
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        freebayes-parallel <(fasta_generate_regions.py /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa.fai 100000) 16 -f /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/data/reference/RefCln_UCBPP-PA14.fa tmp/CH2502/bwa/st_sorted.bam |         bgzip -c > tmp/CH2502/bwa/st_vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule compute_flatcounts:
    input: tmp/CH2500/bwa/st_mapping.coverage
    output: tmp/CH2500/bwa/st_variant.flatcount
    jobid: 26
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

python lib/bam_cov2flatcount.py -in_f tmp/CH2500/bwa/st_mapping.coverage -out_f tmp/CH2500/bwa/st_variant.flatcount

[Mon Aug 20 14:49:42 2018]
rule for_tab_index_vcf:
    input: tmp/CH2502/bwa/st_vcf.gz
    output: tmp/CH2502/bwa/st_vcf.gz.tbi
    jobid: 53
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        tabix -p vcf tmp/CH2502/bwa/st_vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule compute_flatcounts:
    input: tmp/CH2522/bwa/st_mapping.coverage
    output: tmp/CH2522/bwa/st_variant.flatcount
    jobid: 23
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

python lib/bam_cov2flatcount.py -in_f tmp/CH2522/bwa/st_mapping.coverage -out_f tmp/CH2522/bwa/st_variant.flatcount

[Mon Aug 20 14:49:42 2018]
rule compute_flatcounts:
    input: tmp/F1659/bwa/st_mapping.coverage
    output: tmp/F1659/bwa/st_variant.flatcount
    jobid: 22
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

python lib/bam_cov2flatcount.py -in_f tmp/F1659/bwa/st_mapping.coverage -out_f tmp/F1659/bwa/st_variant.flatcount

[Mon Aug 20 14:49:42 2018]
rule for_tab_index_vcf:
    input: tmp/CH2522/bwa/st_vcf.gz
    output: tmp/CH2522/bwa/st_vcf.gz.tbi
    jobid: 45
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        tabix -p vcf tmp/CH2522/bwa/st_vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule for_tab_index_vcf:
    input: tmp/F1659/bwa/st_vcf.gz
    output: tmp/F1659/bwa/st_vcf.gz.tbi
    jobid: 51
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        tabix -p vcf tmp/F1659/bwa/st_vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule for_tab_index_vcf:
    input: tmp/CH2500/bwa/st_vcf.gz
    output: tmp/CH2500/bwa/st_vcf.gz.tbi
    jobid: 47
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        tabix -p vcf tmp/CH2500/bwa/st_vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule compute_flatcounts:
    input: tmp/CH2502/bwa/st_mapping.coverage
    output: tmp/CH2502/bwa/st_variant.flatcount
    jobid: 27
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

python lib/bam_cov2flatcount.py -in_f tmp/CH2502/bwa/st_mapping.coverage -out_f tmp/CH2502/bwa/st_variant.flatcount

[Mon Aug 20 14:49:42 2018]
rule index_vcf:
    input: tmp/CH2502/bwa/vcf.gz
    output: tmp/CH2502/bwa/vcf.gz.tbi
    jobid: 62
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        tabix -p vcf tmp/CH2502/bwa/vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule write_dict_file:
    input: tmp/CH2500/rna_sorted.rmdup.rpg, tmp/CH2502/rna_sorted.rmdup.rpg, tmp/CH2522/rna_sorted.rmdup.rpg, tmp/F1659/rna_sorted.rmdup.rpg
    output: tmp/rpg_dict
    jobid: 10

[Mon Aug 20 14:49:42 2018]
rule index_vcf:
    input: tmp/CH2500/bwa/vcf.gz
    output: tmp/CH2500/bwa/vcf.gz.tbi
    jobid: 67
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        tabix -p vcf tmp/CH2500/bwa/vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule index_vcf:
    input: tmp/CH2522/bwa/vcf.gz
    output: tmp/CH2522/bwa/vcf.gz.tbi
    jobid: 65
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        tabix -p vcf tmp/CH2522/bwa/vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule index_vcf:
    input: tmp/F1659/bwa/vcf.gz
    output: tmp/F1659/bwa/vcf.gz.tbi
    jobid: 64
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        tabix -p vcf tmp/F1659/bwa/vcf.gz
        

[Mon Aug 20 14:49:42 2018]
rule filter_vcf:
    input: tmp/CH2502/bwa/st_vcf.gz, tmp/CH2502/bwa/st_vcf.gz.tbi
    output: tmp/CH2502/bwa/st_variant.snp-vcf
    jobid: 29
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        vcftools --gzvcf tmp/CH2502/bwa/st_vcf.gz --remove-indels --recode         --recode-INFO-all --stdout > tmp/CH2502/bwa/st_variant.snp-vcf
        

[Mon Aug 20 14:49:42 2018]
rule filter_vcf:
    input: tmp/F1659/bwa/st_vcf.gz, tmp/F1659/bwa/st_vcf.gz.tbi
    output: tmp/F1659/bwa/st_variant.snp-vcf
    jobid: 28
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        vcftools --gzvcf tmp/F1659/bwa/st_vcf.gz --remove-indels --recode         --recode-INFO-all --stdout > tmp/F1659/bwa/st_variant.snp-vcf
        

[Mon Aug 20 14:49:42 2018]
rule filter_vcf:
    input: tmp/CH2522/bwa/st_vcf.gz, tmp/CH2522/bwa/st_vcf.gz.tbi
    output: tmp/CH2522/bwa/st_variant.snp-vcf
    jobid: 24
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        vcftools --gzvcf tmp/CH2522/bwa/st_vcf.gz --remove-indels --recode         --recode-INFO-all --stdout > tmp/CH2522/bwa/st_variant.snp-vcf
        

[Mon Aug 20 14:49:42 2018]
rule filter_vcf:
    input: tmp/CH2500/bwa/st_vcf.gz, tmp/CH2500/bwa/st_vcf.gz.tbi
    output: tmp/CH2500/bwa/st_variant.snp-vcf
    jobid: 25
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        vcftools --gzvcf tmp/CH2500/bwa/st_vcf.gz --remove-indels --recode         --recode-INFO-all --stdout > tmp/CH2500/bwa/st_variant.snp-vcf
        

[Mon Aug 20 14:49:42 2018]
rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2500/bwa/vcf.gz, tmp/CH2500/bwa/vcf.gz.tbi
    output: tmp/CH2500/bwa/cons.fa
    jobid: 38
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa


        bcftools consensus -f tmp/reference.target_regions.fa 
        tmp/CH2500/bwa/vcf.gz > tmp/CH2500/bwa/cons.fa
        

[Mon Aug 20 14:49:42 2018]
rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2522/bwa/vcf.gz, tmp/CH2522/bwa/vcf.gz.tbi
    output: tmp/CH2522/bwa/cons.fa
    jobid: 37
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa


        bcftools consensus -f tmp/reference.target_regions.fa 
        tmp/CH2522/bwa/vcf.gz > tmp/CH2522/bwa/cons.fa
        

[Mon Aug 20 14:49:42 2018]
rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/F1659/bwa/vcf.gz, tmp/F1659/bwa/vcf.gz.tbi
    output: tmp/F1659/bwa/cons.fa
    jobid: 36
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa


        bcftools consensus -f tmp/reference.target_regions.fa 
        tmp/F1659/bwa/vcf.gz > tmp/F1659/bwa/cons.fa
        

[Mon Aug 20 14:49:42 2018]
rule create_and_make_expr_table:
    input: tmp/rpg_dict
    output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v4/results/expr.tab
    jobid: 5

[Mon Aug 20 14:49:42 2018]
rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2502/bwa/vcf.gz, tmp/CH2502/bwa/vcf.gz.tbi
    output: tmp/CH2502/bwa/cons.fa
    jobid: 35
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa


        bcftools consensus -f tmp/reference.target_regions.fa 
        tmp/CH2502/bwa/vcf.gz > tmp/CH2502/bwa/cons.fa
        

[Mon Aug 20 14:49:42 2018]
rule create_coding_regions_aln:
    input: tmp/CH2500/bwa/cons.fa, tmp/CH2502/bwa/cons.fa, tmp/CH2522/bwa/cons.fa, tmp/F1659/bwa/cons.fa
    output: tmp/OneBig.aln
    jobid: 17
    wildcards: TMP_D=tmp

[Mon Aug 20 14:49:42 2018]
rule all_snps_table:
    input: tmp/CH2500/bwa/st_variant.flatcount, tmp/CH2502/bwa/st_variant.flatcount, tmp/CH2522/bwa/st_variant.flatcount, tmp/F1659/bwa/st_variant.flatcount, tmp/CH2500/bwa/st_variant.snp-vcf, tmp/CH2502/bwa/st_variant.snp-vcf, tmp/CH2522/bwa/st_variant.snp-vcf, tmp/F1659/bwa/st_variant.snp-vcf, strain_list, Pseudomonas_aeruginosa_PA14_annotation_with_ncRNAs_07_2011_12genes.tab
    output: /all_SNPs.tsv
    jobid: 11

RuleException in line 55 of /net/sgi/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v5/CREATE_SNPS_TABLE.smk:
'OutputFiles' object has no attribute 'all_snps'
