Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	4	convert_to_sin
	1	create_and_make_expr_table
	1	create_coding_regions_aln
	4	create_consensus_sequence
	4	create_vcf
	1	find_best_tree
	4	gene_counts
	4	mapping
	1	postprocess_alignment
	4	process_vcf
	4	rna_mapping
	4	sort_bam
	1	write_dict_file
	38

rule rna_mapping:
    input: data/strains/rna/F1659.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/F1659/sorted.rmdup.sam
    jobid: 34
    wildcards: sample=F1659

Finished job 34.
1 of 38 steps (3%) done

rule convert_to_sin:
    input: tmp/F1659/sorted.rmdup.sam
    output: tmp/F1659/sorted.rmdup.sin
    jobid: 21
    wildcards: TMP_D=tmp, sample=F1659

Removing temporary output file tmp/F1659/sorted.rmdup.sam.
Finished job 21.
2 of 38 steps (5%) done

rule gene_counts:
    input: tmp/F1659/sorted.rmdup.sin
    output: tmp/F1659/sorted.rmdup.rpg
    jobid: 9
    wildcards: TMP_D=tmp, sample=F1659

Removing temporary output file tmp/F1659/sorted.rmdup.sin.
Finished job 9.
3 of 38 steps (8%) done

rule rna_mapping:
    input: data/strains/rna/CH2522.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2522/sorted.rmdup.sam
    jobid: 35
    wildcards: sample=CH2522

Finished job 35.
4 of 38 steps (11%) done

rule convert_to_sin:
    input: tmp/CH2522/sorted.rmdup.sam
    output: tmp/CH2522/sorted.rmdup.sin
    jobid: 22
    wildcards: TMP_D=tmp, sample=CH2522

Removing temporary output file tmp/CH2522/sorted.rmdup.sam.
Finished job 22.
5 of 38 steps (13%) done

rule rna_mapping:
    input: data/strains/rna/CH2502.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2502/sorted.rmdup.sam
    jobid: 33
    wildcards: sample=CH2502

Finished job 33.
6 of 38 steps (16%) done

rule convert_to_sin:
    input: tmp/CH2502/sorted.rmdup.sam
    output: tmp/CH2502/sorted.rmdup.sin
    jobid: 20
    wildcards: TMP_D=tmp, sample=CH2502

Removing temporary output file tmp/CH2502/sorted.rmdup.sam.
Finished job 20.
7 of 38 steps (18%) done

rule rna_mapping:
    input: data/strains/rna/CH2500.fastq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai
    output: tmp/CH2500/sorted.rmdup.sam
    jobid: 36
    wildcards: sample=CH2500

Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.sthash.
Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.stidx.
Finished job 36.
8 of 38 steps (21%) done

rule convert_to_sin:
    input: tmp/CH2500/sorted.rmdup.sam
    output: tmp/CH2500/sorted.rmdup.sin
    jobid: 23
    wildcards: TMP_D=tmp, sample=CH2500

Removing temporary output file tmp/CH2500/sorted.rmdup.sam.
Finished job 23.
9 of 38 steps (24%) done

rule gene_counts:
    input: tmp/CH2522/sorted.rmdup.sin
    output: tmp/CH2522/sorted.rmdup.rpg
    jobid: 10
    wildcards: TMP_D=tmp, sample=CH2522

Removing temporary output file tmp/CH2522/sorted.rmdup.sin.
Finished job 10.
10 of 38 steps (26%) done

rule gene_counts:
    input: tmp/CH2502/sorted.rmdup.sin
    output: tmp/CH2502/sorted.rmdup.rpg
    jobid: 8
    wildcards: TMP_D=tmp, sample=CH2502

Removing temporary output file tmp/CH2502/sorted.rmdup.sin.
Finished job 8.
11 of 38 steps (29%) done

rule gene_counts:
    input: tmp/CH2500/sorted.rmdup.sin
    output: tmp/CH2500/sorted.rmdup.rpg
    jobid: 11
    wildcards: TMP_D=tmp, sample=CH2500

Removing temporary output file tmp/CH2500/sorted.rmdup.sin.
Finished job 11.
12 of 38 steps (32%) done

rule mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/F1659_1.fq.gz, data/strains/dna/F1659_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/F1659/bwa.raw.bam
    jobid: 48
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

Finished job 48.
13 of 38 steps (34%) done

rule sort_bam:
    input: tmp/F1659/bwa.raw.bam
    output: tmp/F1659/bwa.sorted.bam, tmp/F1659/bwa.sorted.bam.bai
    jobid: 44
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

Removing temporary output file tmp/F1659/bwa.raw.bam.
Finished job 44.
14 of 38 steps (37%) done

rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/F1659/bwa.sorted.bam, tmp/F1659/bwa.sorted.bam.bai
    output: tmp/F1659/bwa.vcf
    jobid: 39
    wildcards: TMP_D=tmp, strain=F1659, mapper=bwa

Removing temporary output file tmp/F1659/bwa.sorted.bam.
Removing temporary output file tmp/F1659/bwa.sorted.bam.bai.
Finished job 39.
15 of 38 steps (39%) done

rule mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2500_1.fq.gz, data/strains/dna/CH2500_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2500/bwa.raw.bam
    jobid: 46
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

Finished job 46.
16 of 38 steps (42%) done

rule sort_bam:
    input: tmp/CH2500/bwa.raw.bam
    output: tmp/CH2500/bwa.sorted.bam, tmp/CH2500/bwa.sorted.bam.bai
    jobid: 42
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

Removing temporary output file tmp/CH2500/bwa.raw.bam.
Finished job 42.
17 of 38 steps (45%) done

rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2500/bwa.sorted.bam, tmp/CH2500/bwa.sorted.bam.bai
    output: tmp/CH2500/bwa.vcf
    jobid: 37
    wildcards: TMP_D=tmp, strain=CH2500, mapper=bwa

Removing temporary output file tmp/CH2500/bwa.sorted.bam.bai.
Removing temporary output file tmp/CH2500/bwa.sorted.bam.
Finished job 37.
18 of 38 steps (47%) done

rule mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2522_1.fq.gz, data/strains/dna/CH2522_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2522/bwa.raw.bam
    jobid: 47
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

Finished job 47.
19 of 38 steps (50%) done

rule sort_bam:
    input: tmp/CH2522/bwa.raw.bam
    output: tmp/CH2522/bwa.sorted.bam, tmp/CH2522/bwa.sorted.bam.bai
    jobid: 43
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

Removing temporary output file tmp/CH2522/bwa.raw.bam.
Finished job 43.
20 of 38 steps (53%) done

rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2522/bwa.sorted.bam, tmp/CH2522/bwa.sorted.bam.bai
    output: tmp/CH2522/bwa.vcf
    jobid: 38
    wildcards: TMP_D=tmp, strain=CH2522, mapper=bwa

Removing temporary output file tmp/CH2522/bwa.sorted.bam.bai.
Removing temporary output file tmp/CH2522/bwa.sorted.bam.
Finished job 38.
21 of 38 steps (55%) done

rule mapping:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, data/strains/dna/CH2502_1.fq.gz, data/strains/dna/CH2502_2.fq.gz, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt
    output: tmp/CH2502/bwa.raw.bam
    jobid: 49
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.bwt.
Finished job 49.
22 of 38 steps (58%) done

rule sort_bam:
    input: tmp/CH2502/bwa.raw.bam
    output: tmp/CH2502/bwa.sorted.bam, tmp/CH2502/bwa.sorted.bam.bai
    jobid: 45
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file tmp/CH2502/bwa.raw.bam.
Finished job 45.
23 of 38 steps (61%) done

rule create_vcf:
    input: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa, /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai, tmp/CH2502/bwa.sorted.bam, tmp/CH2502/bwa.sorted.bam.bai
    output: tmp/CH2502/bwa.vcf
    jobid: 40
    wildcards: TMP_D=tmp, strain=CH2502, mapper=bwa

Removing temporary output file tmp/CH2502/bwa.sorted.bam.
Removing temporary output file tmp/CH2502/bwa.sorted.bam.bai.
Removing temporary output file /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/data/reference/RefCln_UCBPP-PA14.fa.fai.
Finished job 40.
24 of 38 steps (63%) done

rule write_dict_file:
    input: tmp/CH2500/sorted.rmdup.rpg, tmp/CH2502/sorted.rmdup.rpg, tmp/CH2522/sorted.rmdup.rpg, tmp/F1659/sorted.rmdup.rpg
    output: tmp/rpg_dict
    jobid: 5

Removing temporary output file tmp/CH2502/sorted.rmdup.rpg.
Removing temporary output file tmp/F1659/sorted.rmdup.rpg.
Removing temporary output file tmp/CH2522/sorted.rmdup.rpg.
Removing temporary output file tmp/CH2500/sorted.rmdup.rpg.
Finished job 5.
25 of 38 steps (66%) done

rule process_vcf:
    input: tmp/CH2522/bwa.vcf
    output: tmp/CH2522/bwa.vcf.gz
    jobid: 30
    wildcards: TMP_D=tmp, strains=CH2522, mapper=bwa

Finished job 30.
26 of 38 steps (68%) done

rule process_vcf:
    input: tmp/CH2502/bwa.vcf
    output: tmp/CH2502/bwa.vcf.gz
    jobid: 32
    wildcards: TMP_D=tmp, strains=CH2502, mapper=bwa

Finished job 32.
27 of 38 steps (71%) done

rule process_vcf:
    input: tmp/F1659/bwa.vcf
    output: tmp/F1659/bwa.vcf.gz
    jobid: 31
    wildcards: TMP_D=tmp, strains=F1659, mapper=bwa

Finished job 31.
28 of 38 steps (74%) done

rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2522/bwa.vcf.gz
    output: tmp/CH2522/bwa.cons.fa
    jobid: 17
    wildcards: TMP_D=tmp, strains=CH2522, mapper=bwa

Finished job 17.
29 of 38 steps (76%) done

rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2502/bwa.vcf.gz
    output: tmp/CH2502/bwa.cons.fa
    jobid: 19
    wildcards: TMP_D=tmp, strains=CH2502, mapper=bwa

Finished job 19.
30 of 38 steps (79%) done

rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/F1659/bwa.vcf.gz
    output: tmp/F1659/bwa.cons.fa
    jobid: 18
    wildcards: TMP_D=tmp, strains=F1659, mapper=bwa

Finished job 18.
31 of 38 steps (82%) done

rule process_vcf:
    input: tmp/CH2500/bwa.vcf
    output: tmp/CH2500/bwa.vcf.gz
    jobid: 28
    wildcards: TMP_D=tmp, strains=CH2500, mapper=bwa

Finished job 28.
32 of 38 steps (84%) done

rule create_consensus_sequence:
    input: tmp/reference.target_regions.fa, tmp/CH2500/bwa.vcf.gz
    output: tmp/CH2500/bwa.cons.fa
    jobid: 16
    wildcards: TMP_D=tmp, strains=CH2500, mapper=bwa

Finished job 16.
33 of 38 steps (87%) done

rule create_coding_regions_aln:
    input: tmp/CH2500/bwa.cons.fa, tmp/CH2502/bwa.cons.fa, tmp/CH2522/bwa.cons.fa, tmp/F1659/bwa.cons.fa
    output: tmp/OneBig.aln
    jobid: 7
    wildcards: TMP_D=tmp

Finished job 7.
34 of 38 steps (89%) done

rule postprocess_alignment:
    input: tmp/OneBig.aln
    output: tmp/OneBig.var.aln
    jobid: 4
    wildcards: TMP_D=tmp

Finished job 4.
35 of 38 steps (92%) done

rule find_best_tree:
    input: tmp/OneBig.var.aln
    output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/results/Paeru.nwk
    jobid: 1

    Error in rule find_best_tree:
        jobid: 1
        output: /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/results/Paeru.nwk

RuleException:
CalledProcessError in line 21 of /net/sgi/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/INFER_TREE.smk:
Command ' set -euo pipefail;  /home/thkuo/miniconda3/envs/phypal/bin/raxmlHPC-PTHREADS -T 16 -w /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/results -m GTRGAMMA -s tmp/OneBig.var.aln -n OneBig.var -p 1 -N 1;cp -s /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/results/RAxML_bestTree.OneBig.var /net/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/results/Paeru.nwk ' returned non-zero exit status 255.
  File "/net/sgi/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/INFER_TREE.smk", line 21, in __rule_find_best_tree
  File "/home/thkuo/miniconda3/envs/phypal/lib/python3.6/concurrent/futures/thread.py", line 55, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /net/sgi/metagenomics/data/from_moni/old.tzuhao/seq2geno/dev_versions/v3/.snakemake/log/2018-07-10T205248.828854.snakemake.log
